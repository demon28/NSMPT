
@{
    ViewBag.Title = "Index";
}

@section Pageheader{


    <h1>
        <small>  Template</small>

    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Template</li>
    </ol>

}




<section class="content">

    <div class="row">
        <div class="col-md-3">
            <!--标签列表-->
            <div class="box box-info" id="app_mark">

                <div class="box-header with-border">
                    <h3 class="box-title">System Tags</h3>
                </div>

                <div class="box-body">

                    <ul class="list-group">
                        <li class="list-group-item" v-for="item in items">

                            <a>{{item.MarkName}}</a>&nbsp;&nbsp;
                            <a class="pull-right">{{item.MarkValue}}</a>&nbsp;&nbsp;

                        </li>

                    </ul>


                </div>
                <!-- /.box-body -->
            </div>
            <!--/标签列表-->
            <!-- /.box -->
        </div>
        <!-- /.col -->
        <!--模板列表-->
        <div class="col-md-9">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">Template List</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>

                    </div>


                </div>
                <!-- /.box-header -->
                <div class="box-body table-responsive no-padding" id="App_Temp">
                    <table class="table table-hover" id="tab_contact">
                        <tbody>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Date</th>
                                <th>operation</th>
                            </tr>
                            <tr v-for="(item,index) in Data">
                                <td>{{item.MtId}}</td>
                                <td>{{item.TempName}}</td>
                                <td>{{item.Createtime}}</td>

                                <td>

                                    <button type="button" class="btn bg-purple  btn-xs" v-on:click="updateitem(item)">查看</button>  &nbsp; &nbsp;
                                    <button type="button" class="btn bg-maroon  btn-xs" v-on:click="deleteitem(item)">删除</button> &nbsp;

                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                <div class="box-footer">
                    <button type="button" class="btn btn-sm m-4 btn-success pull-left" id="btn_downloadtemp" style="margin-left:20px;margin-top:15px">下载模板</button>
                </div>
                <!-- /.box-body -->
            </div>


            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">View Template Content</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>

                    </div>


                </div>
                <!-- /.box-header -->
                <div class="box-body table-responsive no-padding" id="App_Temp">
                    <textarea name="description" id="description"></textarea>
                </div>

                <!-- /.box-body -->
            </div>


        </div>
        <!--/模板列表-->
        <!-- /.col -->
    </div>
    <!-- /.row -->

</section>




@section scripts{

    <script src="~/Reference/scripts/vue-pager.js"></script>
    <script src="~/Reference/ckeditor/ckeditor.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            CKEDITOR.replace('description', {
                height: 400
            });
        }
        var mark_vm;
        var temp_vm;
        var dialog;
        $(document).ready(function () {

            bindMarkView();
            bindTempView();
            SetEvent();

        });


        function bindMarkView() {

            mark_vm = new Vue({
                el: "#app_mark",
                data: { items: {} },
                created: function () {
                    this.Init();
                },
                methods: {
                    Init: function () {

                        var self = this;
                        $.ajax({
                            url: "/Template/ListMark",
                            type: "POST",
                            success: function (result) {

                                if (result.Success) {
                                    self.items = result.Content.Data;

                                } else {
                                    alert_danger("加载数据失败！");
                                }
                            }

                        })

                    }
                }


            });


        }
        function bindTempView() {
            contact_vm = wui.pagination({
                el: "#App_Temp",
                url: "/Template/ListTemp",
                query: function () {

                },
                methods: {
                    updateitem: function (item) {


                    },
                    deleteitem: function (item) {

                        $.ajax({
                            url: "/Template/DelTemp",
                            type: "POST",
                            data: {
                                ContactId: item.ContactId
                            },
                            success: function (result) {
                                if (result.Success) {
                                    alert_success("删除成功！");
                                    contact_vm.reload();

                                } else {
                                    alert_danger(result.Message);
                                }
                            }
                        })
                    },

                },
                showTips: alert_danger
            });

        }
        function SetEvent() {

        }

    </script>




}
